{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.appointment.js)\r\n * Version: 19.1.6 (build 19263-1729)\r\n * Build date: Fri Sep 20 2019\r\n *\r\n * Copyright (c) 2012 - 2019 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _translator = require(\"../../animation/translator\");\n\nvar _translator2 = _interopRequireDefault(_translator);\n\nvar _utils = require(\"./utils.recurrence\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _component_registrator = require(\"../../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _ui = require(\"../tooltip/ui.tooltip\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _uiScheduler = require(\"./ui.scheduler.publisher_mixin\");\n\nvar _uiScheduler2 = _interopRequireDefault(_uiScheduler);\n\nvar _utils3 = require(\"../../events/utils\");\n\nvar _utils4 = _interopRequireDefault(_utils3);\n\nvar _pointer = require(\"../../events/pointer\");\n\nvar _pointer2 = _interopRequireDefault(_pointer);\n\nvar _dom_component = require(\"../../core/dom_component\");\n\nvar _dom_component2 = _interopRequireDefault(_dom_component);\n\nvar _resizable = require(\"../resizable\");\n\nvar _resizable2 = _interopRequireDefault(_resizable);\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _date = require(\"../../localization/date\");\n\nvar _date2 = _interopRequireDefault(_date);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar DEFAULT_HORIZONTAL_HANDLES = \"left right\";\nvar DEFAULT_VERTICAL_HANDLES = \"top bottom\";\n\nvar REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME = _utils4.default.addNamespace(_pointer2.default.enter, \"dxSchedulerAppointment\"),\n    REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME = _utils4.default.addNamespace(_pointer2.default.leave, \"dxSchedulerAppointment\");\n\nvar EMPTY_APPOINTMENT_CLASS = \"dx-scheduler-appointment-empty\",\n    APPOINTMENT_ALL_DAY_ITEM_CLASS = \"dx-scheduler-all-day-appointment\",\n    DIRECTION_APPOINTMENT_CLASSES = {\n  horizontal: \"dx-scheduler-appointment-horizontal\",\n  vertical: \"dx-scheduler-appointment-vertical\"\n},\n    RECURRENCE_APPOINTMENT_CLASS = \"dx-scheduler-appointment-recurrence\",\n    COMPACT_APPOINTMENT_CLASS = \"dx-scheduler-appointment-compact\",\n    REDUCED_APPOINTMENT_CLASS = \"dx-scheduler-appointment-reduced\",\n    REDUCED_APPOINTMENT_ICON = \"dx-scheduler-appointment-reduced-icon\",\n    REDUCED_APPOINTMENT_PARTS_CLASSES = {\n  head: \"dx-scheduler-appointment-head\",\n  body: \"dx-scheduler-appointment-body\",\n  tail: \"dx-scheduler-appointment-tail\"\n};\n\nvar Appointment = _dom_component2.default.inherit({\n  _getDefaultOptions: function _getDefaultOptions() {\n    return (0, _extend.extend)(this.callBase(), {\n      data: {},\n      geometry: {\n        top: 0,\n        left: 0,\n        width: 0,\n        height: 0\n      },\n      allowDrag: true,\n      allowResize: true,\n      reduced: null,\n      isCompact: false,\n      direction: \"vertical\",\n      resizableConfig: {},\n      cellHeight: 0,\n      cellWidth: 0\n    });\n  },\n  _optionChanged: function _optionChanged(args) {\n    switch (args.name) {\n      case \"data\":\n      case \"geometry\":\n      case \"allowDrag\":\n      case \"allowResize\":\n      case \"reduced\":\n      case \"sortedIndex\":\n      case \"isCompact\":\n      case \"direction\":\n      case \"resizableConfig\":\n      case \"cellHeight\":\n      case \"cellWidth\":\n        this._invalidate();\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _getHorizontalResizingRule: function _getHorizontalResizingRule() {\n    var reducedHandles = {\n      head: this.option(\"rtlEnabled\") ? \"right\" : \"left\",\n      body: \"\",\n      tail: this.option(\"rtlEnabled\") ? \"left\" : \"right\"\n    };\n    return {\n      handles: this.option(\"reduced\") ? reducedHandles[this.option(\"reduced\")] : DEFAULT_HORIZONTAL_HANDLES,\n      minHeight: 0,\n      minWidth: this.invoke(\"getCellWidth\"),\n      step: this.invoke(\"getResizableStep\")\n    };\n  },\n  _getVerticalResizingRule: function _getVerticalResizingRule() {\n    var height = this.invoke(\"getCellHeight\");\n    return {\n      handles: DEFAULT_VERTICAL_HANDLES,\n      minWidth: 0,\n      minHeight: height,\n      step: height\n    };\n  },\n  _render: function _render() {\n    this.callBase();\n\n    this._renderAppointmentGeometry();\n\n    this._renderEmptyClass();\n\n    this._renderCompactClass();\n\n    this._renderReducedAppointment();\n\n    this._renderAllDayClass();\n\n    this._renderDirection();\n\n    this.$element().data(\"dxAppointmentStartDate\", this.option(\"startDate\"));\n    this.$element().attr(\"title\", this.invoke(\"getField\", \"text\", this.option(\"data\")));\n    this.$element().attr(\"role\", \"button\");\n\n    this._renderRecurrenceClass();\n\n    this._renderResizable();\n  },\n  _renderAppointmentGeometry: function _renderAppointmentGeometry() {\n    var geometry = this.option(\"geometry\"),\n        $element = this.$element();\n\n    _translator2.default.move($element, {\n      top: geometry.top,\n      left: geometry.left\n    });\n\n    $element.css({\n      width: geometry.width < 0 ? 0 : geometry.width,\n      height: geometry.height < 0 ? 0 : geometry.height\n    });\n  },\n  _renderEmptyClass: function _renderEmptyClass() {\n    var geometry = this.option(\"geometry\");\n\n    if (geometry.empty || this.option(\"isCompact\")) {\n      this.$element().addClass(EMPTY_APPOINTMENT_CLASS);\n    }\n  },\n  _renderReducedAppointment: function _renderReducedAppointment() {\n    var reducedPart = this.option(\"reduced\");\n\n    if (!reducedPart) {\n      return;\n    }\n\n    this.$element().toggleClass(REDUCED_APPOINTMENT_CLASS, true).toggleClass(REDUCED_APPOINTMENT_PARTS_CLASSES[reducedPart], true);\n\n    this._renderAppointmentReducedIcon();\n  },\n  _renderAppointmentReducedIcon: function _renderAppointmentReducedIcon() {\n    var $icon = (0, _renderer2.default)(\"<div>\").addClass(REDUCED_APPOINTMENT_ICON).appendTo(this.$element()),\n        endDate = this._getEndDate();\n\n    var tooltipLabel = _message2.default.format(\"dxScheduler-editorLabelEndDate\"),\n        tooltipText = [tooltipLabel, \": \", _date2.default.format(endDate, \"monthAndDay\"), \", \", _date2.default.format(endDate, \"year\")].join(\"\");\n\n    _events_engine2.default.off($icon, REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME);\n\n    _events_engine2.default.on($icon, REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME, function () {\n      _ui2.default.show({\n        target: $icon,\n        content: tooltipText\n      });\n    });\n\n    _events_engine2.default.off($icon, REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME);\n\n    _events_engine2.default.on($icon, REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME, function () {\n      _ui2.default.hide();\n    });\n  },\n  _getEndDate: function _getEndDate() {\n    var result = this.invoke(\"getField\", \"endDate\", this.option(\"data\"));\n\n    if (result) {\n      return new Date(result);\n    }\n\n    return result;\n  },\n  _renderAllDayClass: function _renderAllDayClass() {\n    this.$element().toggleClass(APPOINTMENT_ALL_DAY_ITEM_CLASS, !!this.option(\"allDay\"));\n  },\n  _renderRecurrenceClass: function _renderRecurrenceClass() {\n    var rule = this.invoke(\"getField\", \"recurrenceRule\", this.option(\"data\"));\n\n    if (_utils2.default.getRecurrenceRule(rule).isValid) {\n      this.$element().addClass(RECURRENCE_APPOINTMENT_CLASS);\n    }\n  },\n  _renderCompactClass: function _renderCompactClass() {\n    this.$element().toggleClass(COMPACT_APPOINTMENT_CLASS, !!this.option(\"isCompact\"));\n  },\n  _renderDirection: function _renderDirection() {\n    this.$element().addClass(DIRECTION_APPOINTMENT_CLASSES[this.option(\"direction\")]);\n  },\n  _createResizingConfig: function _createResizingConfig() {\n    var config = \"vertical\" === this.option(\"direction\") ? this._getVerticalResizingRule() : this._getHorizontalResizingRule();\n    config.roundStepValue = true;\n\n    if (!this.invoke(\"isGroupedByDate\")) {\n      config.stepPrecision = \"strict\";\n    }\n\n    return config;\n  },\n  _renderResizable: function _renderResizable() {\n    if (this.option(\"allowResize\") && !this.option(\"isCompact\")) {\n      this._createComponent(this.$element(), _resizable2.default, (0, _extend.extend)(this._createResizingConfig(), this.option(\"resizableConfig\")));\n    }\n  }\n}).include(_uiScheduler2.default);\n\n(0, _component_registrator2.default)(\"dxSchedulerAppointment\", Appointment);\nmodule.exports = Appointment;","map":null,"metadata":{},"sourceType":"script"}